
2024-06-24 19:44

Source: 

Tags: [[pwntools]]

#### Checksec tool

##### RELRO
stands for Relocation Read-Only, which makes the global offset table (GOT) read-only after the linker resolves functions to it. The GOT is important for techniques such as the ret-to-libc attack you can refer to this blog post: [https://www.redhat.com/en/blog/hardening-elf-binaries-using-relocation-read-only-relro](https://www.redhat.com/en/blog/hardening-elf-binaries-using-relocation-read-only-relro).
##### Stack canaries 
are tokens placed after a stack to detect a stack overflow. stack canaries sit beside the stack in memory (where the program variables are stored), and if there is a stack overflow, then the canary will be corrupted. This allows the program to detect a buffer overflow and shut down. You can read more about stack canaries here: [https://www.sans.org/blog/stack-canaries-gingerly-sidestepping-the-cage/](https://www.sans.org/blog/stack-canaries-gingerly-sidestepping-the-cage/).
##### NX
is short for non-executable. If this is enabled, then memory segments can be either writable or executable, but not both. This stops potential attackers from injecting their own malicious code (called shellcode) into the program, because something in a writable segment cannot be executed. - [https://en.wikipedia.org/wiki/Executable_space_protection](https://en.wikipedia.org/wiki/Executable_space_protection)
##### PIE
stands for Position Independent Executable. This loads the program dependencies into random locations, so attacks that rely on memory layout are more difficult to conduct. Here is a good blog about this: [https://access.redhat.com/blogs/766093/posts/1975793](https://access.redhat.com/blogs/766093/posts/1975793)

#### Cyclic

If you view the c code, you may notice the` print_flag() `function, which will open the flag with the permissions we need. The issue is that the function does not run in the program, the program simply calls start() then ends.

- This program is vulnerable to a buffer overflow, because it uses the `gets()` function, which does not check to see if the user input is actually in bounds (you can read about this [here](https://faq.cprogramming.com/cgi-bin/smartfaq.cgi?answer=1049157810&id=1043284351))
- An important part of the memory we can overwrite is the instruction pointer (`IP`), which is called the `eip` on 32-bit machines, and `rip` on 64-bit machines.
- To control the `IP`, the first thing we need do is to is overflow the stack with a pattern, so we can see where the IP is

fire up `gdb` using `gdb file_name`
To run a program in gdb, type `r`


### References

[TryHackMe | Intro To Pwntools](https://tryhackme.com/r/room/introtopwntools)